---
ansible:
  executor:
    args:
      ansible_playbook:
        - --inventory=${MOLECULE_SCENARIO_DIRECTORY}/inventory
  env:
    ANSIBLE_CALLBACK_RESULT_FORMAT: yaml
    ANSIBLE_DIFF_ALWAYS: "True"
    ANSIBLE_PIPELINING: "True"

dependency:
  name: galaxy
  options:
    # Pointing to the default directory doesn't seem to work properly
    requirements-file: ${MOLECULE_SCENARIO_DIRECTORY}/../default/requirements.yml

platforms:
  - name: debian-zfs-root-mirror

provisioner:
  playbooks:
    create: ../default/create.yml
    destroy: ../default/destroy.yml
    converge: ../default/converge.yml
    prepare: ../default/prepare.yml
    verify: ../default/verify.yml

scenario:
  converge_sequence:
    - dependency
    - syntax
    - create
    - converge
  create_sequence:
    - dependency
    - syntax
    - create
  test_sequence:
    - dependency
    - syntax
    - destroy
    - create
    - converge
    - verify
    - destroy
